{"is_source_file": true, "format": "JavaScript", "description": "This file implements an Express middleware function for authentication using Supabase. It processes the authorization header, validates the token, retrieves user profile information, and attaches user data to the request object.", "external_files": ["../utils/supabase"], "external_methods": ["supabase.auth.getUser", "getAuthenticatedSupabase"], "published": ["authMiddleware"], "classes": [], "methods": [{"name": "authMiddleware", "description": "Asynchronous Express middleware that authenticates the user via Supabase token, fetches user profile data, and attaches it to the request object."}], "calls": ["supabase.auth.getUser", "getAuthenticatedSupabase", "authClient.from", "authClient.select"], "search-terms": ["authMiddleware", "Supabase token validation", "authorization header", "authProfile fetch", "middleware", "auth.js"], "state": 2, "file_id": 35, "knowledge_revision": 176, "git_revision": "d51d1ebff7faa7bdb5f0ba64979db9f0108fdab1", "revision_history": [{"110": "d51d1ebff7faa7bdb5f0ba64979db9f0108fdab1"}, {"176": "d51d1ebff7faa7bdb5f0ba64979db9f0108fdab1"}], "ctags": [{"_type": "tag", "name": "authClient", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^    const authClient = getAuthenticatedSupabase(token);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "authHeader", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^    const authHeader = req.headers.authorization;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "authMiddleware", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^const authMiddleware = async (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^      email: user.email,$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^      id: user.id,$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "org_id", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^      org_id: profile?.org_id,$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "role", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^      role: profile?.role$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^    const token = authHeader.replace('Bearer ', '');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/strategic-growth-platform-221604-221613/sge_backend/src/middleware/auth.js", "pattern": "/^    req.user = {$/", "language": "JavaScript", "kind": "class", "scope": "req", "scopeKind": "class"}], "hash": "ac0738c037e4966f2be489005e47a15c", "format-version": 4, "code-base-name": "sge_backend", "filename": "sge_backend/src/middleware/auth.js", "fields": [{"name": "email: user.email,", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}, {"name": "id: user.id,", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}, {"name": "org_id: profile?.org_id,", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}, {"name": "role: profile?.role", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}]}